!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.feathers=t():e.feathers=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";var n=r(1),o=r(7),i=r(8),s=r(9);e.exports=Object.assign({},n,i,{hooks:o,filterQuery:s})},function(e,t,r){"use strict";(function(e){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.stripSlashes=function(e){return e.replace(/^(\/*)|(\/*)$/g,"")};var n=t._={each:function(e,t){e&&"function"==typeof e.forEach?e.forEach(t):n.isObject(e)&&Object.keys(e).forEach(function(r){return t(e[r],r)})},some:function(e,t){return Object.keys(e).map(function(t){return[e[t],t]}).some(function(e){var r=e[0],n=e[1];return t(r,n)})},every:function(e,t){return Object.keys(e).map(function(t){return[e[t],t]}).every(function(e){var r=e[0],n=e[1];return t(r,n)})},keys:function(e){return Object.keys(e)},values:function(e){return n.keys(e).map(function(t){return e[t]})},isMatch:function(e,t){return n.keys(t).every(function(r){return e[r]===t[r]})},isEmpty:function(e){return 0===n.keys(e).length},isObject:function(e){return"object"===(void 0===e?"undefined":r(e))&&!Array.isArray(e)&&null!==e},extend:function(){return Object.assign.apply(Object,arguments)},omit:function(e){for(var t=n.extend({},e),r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.forEach(function(e){return delete t[e]}),t},pick:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce(function(t,r){return void 0!==e[r]&&(t[r]=e[r]),t},{})},merge:function(e,t){return n.isObject(e)&&n.isObject(t)&&Object.keys(t).forEach(function(r){var o,i;n.isObject(t[r])?(e[r]||Object.assign(e,((o={})[r]={},o)),n.merge(e[r],t[r])):Object.assign(e,((i={})[r]=t[r],i))}),e}};t.select=function(e){for(var t=e&&e.query&&e.query.$select,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];Array.isArray(t)&&o.length&&t.push.apply(t,o);var s=function(e){return Array.isArray(t)?n.pick.apply(n,[e].concat(t)):e};return function(e){return Array.isArray(e)?e.map(s):s(e)}},t.isPromise=function(e){return n.isObject(e)&&"function"==typeof e.then},t.makeUrl=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="function"==typeof n.get?n.get.bind(n):function(){},i=o("env")||"production",s=o("host")||e.env.HOST_NAME||"localhost",u="development"===i||"test"===i||void 0===i?"http":"https",c=o("port")||e.env.PORT||3030;return r=r||"",u+"://"+s+("development"===i||"test"===i||void 0===i?":"+c:"")+"/"+t.stripSlashes(r)},t.compareNSB=function(e,t){return e<t?-1:e>t?1:0},t.compareArrays=function(e,r){var n,o;for(n=0;n<Math.min(e.length,r.length);n+=1)if(0!==(o=t.compare(e[n],r[n])))return o;return t.compareNSB(e.length,r.length)},t.compare=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.compareNSB,o=t,i=o.compareNSB,s=o.compare,u=o.compareArrays;if(void 0===e)return void 0===r?0:-1;if(void 0===r)return void 0===e?0:1;if(null===e)return null===r?0:-1;if(null===r)return null===e?0:1;if("number"==typeof e)return"number"==typeof r?i(e,r):-1;if("number"==typeof r)return"number"==typeof e?i(e,r):1;if("string"==typeof e)return"string"==typeof r?n(e,r):-1;if("string"==typeof r)return"string"==typeof e?n(e,r):1;if("boolean"==typeof e)return"boolean"==typeof r?i(e,r):-1;if("boolean"==typeof r)return"boolean"==typeof e?i(e,r):1;if(e instanceof Date)return r instanceof Date?i(e.getTime(),r.getTime()):-1;if(r instanceof Date)return e instanceof Date?i(e.getTime(),r.getTime()):1;if(Array.isArray(e))return Array.isArray(r)?u(e,r):-1;if(Array.isArray(r))return Array.isArray(e)?u(e,r):1;for(var c=Object.keys(e).sort(),a=Object.keys(r).sort(),f=0,l=0;l<Math.min(c.length,a.length);l+=1)if(0!==(f=s(e[c[l]],r[a[l]])))return f;return i(c.length,a.length)},t.sorter=function(e){var r=Object.keys(e).map(function(t){return{key:t,direction:e[t]}});return function(e,n){for(var o=void 0,i=0;i<r.length;i++){var s=r[i];if(0!=(o=s.direction*t.compare(e[s.key],n[s.key])))return o}return 0}}}).call(this,r(3))},function(e,t,r){var n,o;void 0===(o="function"==typeof(n=function(){var e="function"==typeof Object.getOwnPropertySymbols;return{create:function(){var e=Object.create(this),t="string"==typeof e.__init?e.__init:"init";return"function"==typeof e[t]&&e[t].apply(e,arguments),e},mixin:function(t,r){var n=r||this,o=/\b_super\b/,i=Object.getPrototypeOf(n)||n.prototype,s={},u=t,c=function(e){var t=Object.getOwnPropertyDescriptor(u,e);!s[e]&&t&&(s[e]=t)};do{Object.getOwnPropertyNames(u).forEach(c),e&&Object.getOwnPropertySymbols(u).forEach(c)}while((u=Object.getPrototypeOf(u))&&Object.getPrototypeOf(u));var a=function(t){var r=s[t];"function"==typeof r.value&&o.test(r.value)&&(r.value=function(t,r,n,o){var i="function"==typeof r,s=function(){var e=this._super;this._super=i?r:t[n];var s=o.apply(this,arguments);return this._super=e,s};return i&&e&&Object.getOwnPropertySymbols(r).forEach(function(e){s[e]=r[e]}),s}(i,n[t],t,r.value)),Object.defineProperty(n,t,r)};return Object.keys(s).forEach(a),e&&Object.getOwnPropertySymbols(s).forEach(a),n},extend:function(e,t){return this.mixin(e,Object.create(t||this))},proxy:function(e){var t=this[e],r=Array.prototype.slice.call(arguments,1);return r.unshift(this),t.bind.apply(t,r)}}})?n.apply(t,[]):n)||(e.exports=o)},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,a=[],f=!1,l=-1;function p(){f&&c&&(f=!1,c.length?a=c.concat(a):l=-1,a.length&&h())}function h(){if(!f){var e=u(p);f=!0;for(var t=a.length;t;){for(c=a,a=[];++l<t;)c&&c[l].run();l=-1,t=a.length}c=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new v(e,t)),1!==a.length||f||u(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){"use strict";e.exports="3.1.7"},function(e,t,r){"use strict";e.exports=r(6)},function(e,t,r){"use strict";var n=r(0).hooks,o=r(2),i=r(10),s=r(4);function u(){var e={};return o.mixin(i,e),e.init(),e}u.version=s,u.SKIP=n.SKIP,e.exports=u,e.exports.default=u},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(1)._,i=o.each,s=o.pick,u=t.SKIP="undefined"!=typeof Symbol?Symbol("__feathersSkipHooks"):"__feathersSkipHooks",c=function(e){var t=e[0],r=e[1];return{id:t,params:void 0===r?{}:r}},a=function(e){var t=e[0],r=e[1],n=e[2];return{id:t,data:r,params:void 0===n?{}:n}};t.converters={find:function(e){var t=e[0];return{params:void 0===t?{}:t}},create:function(e){var t=e[0],r=e[1];return{data:t,params:void 0===r?{}:r}},get:c,remove:c,update:a,patch:a},t.createHookObject=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.converters[e](r);return Object.defineProperty(o,"toJSON",{value:function(){return s(this,"type","method","path","params","id","data","result","error")}}),Object.assign(o,n,{method:e,get path(){var e=n.app,t=n.service;return t&&e&&e.services?Object.keys(e.services).find(function(r){return e.services[r]===t}):null}})},t.defaultMakeArguments=function(e){var t=[];return void 0!==e.id&&t.push(e.id),e.data&&t.push(e.data),t.push(e.params||{}),t},t.makeArguments=function(e){switch(e.method){case"find":return[e.params];case"get":case"remove":return[e.id,e.params];case"update":case"patch":return[e.id,e.data,e.params];case"create":return[e.data,e.params]}return t.defaultMakeArguments(e)},t.convertHookData=function(e){var t={};return Array.isArray(e)?t={all:e}:"object"!==(void 0===e?"undefined":n(e))?t={all:[e]}:i(e,function(e,r){t[r]=Array.isArray(e)?e:[e]}),t},t.isHookObject=function(e){return"object"===(void 0===e?"undefined":n(e))&&"string"==typeof e.method&&"string"==typeof e.type},t.getHooks=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.__hooks[r][n]||[],s=t.__hooks[r][n]||[];return o?s.concat(i):i.concat(s)},t.processHooks=function(e,r){var n=this,o=r,i=function(e){if(e){if(e===u)return u;if(!t.isHookObject(e))throw new Error(o.type+" hook for '"+o.method+"' method returned invalid hook object");o=e}return o};return e.reduce(function(e,t){var r=t.bind(n);return(e=2===r.length?e.then(function(e){return e===u?u:new Promise(function(t,n){r(e,function(e,r){return e?n(e):t(r)})})}):e.then(function(e){return e===u?u:r(e)})).then(i)},Promise.resolve(o)).then(function(){return o}).catch(function(e){throw e.hook=o,e})},t.enableHooks=function(e,r,n){if("function"==typeof e.hooks)return e;var o={};return n.forEach(function(e){o[e]={}}),Object.defineProperty(e,"__hooks",{value:o}),Object.assign(e,{hooks:function(e){var n=this;return i(e,function(e,o){if(!n.__hooks[o])throw new Error("'"+o+"' is not a valid hook type");var s=t.convertHookData(e);i(s,function(e,t){if("all"!==t&&-1===r.indexOf(t))throw new Error("'"+t+"' is not a valid hook method")}),r.forEach(function(e){var t=n.__hooks[o][e]||(n.__hooks[o][e]=[]);s.all&&t.push.apply(t,s.all),s[e]&&t.push.apply(t,s[e])})}),this}})}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o={find:1,get:2,create:2,update:3,patch:3,remove:2};function i(e){return"object"===(void 0===e?"undefined":n(e))&&null!==e}t.validateArguments=function(e,t){if("function"==typeof t[t.length-1])throw new Error("Callbacks are no longer supported. Use Promises or async/await instead.");var r=o[e];if(r&&t.length>r)throw new Error("Too many arguments for '"+e+"' method");var n=t[r-1];if(void 0!==n&&!i(n))throw new Error("Params for '"+e+"' method must be an object");switch(e){case"create":if(!i(t[0]))throw new Error("A data object must be provided to the 'create' method");break;case"get":case"remove":case"update":case"patch":if(void 0===t[0])throw new Error("An id must be provided to the '"+e+"' method");if(("update"===e||"patch"===e)&&!i(t[1]))throw new Error("A data object must be provided to the '"+e+"' method")}return!0}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(1)._,i=["$sort","$limit","$skip","$select","$populate"];function s(e){if(void 0!==e)return Math.abs(parseInt(e,10))}e.exports=function(e,t){return{filters:{$sort:function(e){if("object"!==(void 0===e?"undefined":n(e))||Array.isArray(e))return e;var t={};return Object.keys(e).forEach(function(r){t[r]="object"===n(e[r])?e[r]:parseInt(e[r],10)}),t}(e.$sort),$limit:function(e,t){if(t&&t.default){var r="number"==typeof e?e:t.default,n="number"==typeof t.max?t.max:Number.MAX_VALUE;return Math.min(r,n)}return e}(s(e.$limit),t),$skip:s(e.$skip),$select:e.$select,$populate:e.$populate},query:o.omit.apply(o,[e].concat(i))}}},function(e,t,r){"use strict";var n=r(11)("feathers:application"),o=r(0).stripSlashes,i=r(2),s=r(14),u=r(16),c=r(4),a=i.extend({create:null}),f={init:function(){Object.assign(this,{version:c,methods:["find","get","create","update","patch","remove"],mixins:[],services:{},providers:[],_setup:!1,settings:{}}),this.configure(u()),this.configure(s())},get:function(e){return this.settings[e]},set:function(e,t){return this.settings[e]=t,this},disable:function(e){return this.settings[e]=!1,this},disabled:function(e){return!this.settings[e]},enable:function(e){return this.settings[e]=!0,this},enabled:function(e){return!!this.settings[e]},configure:function(e){return e.call(this,this),this},service:function(e,t){if(void 0!==t)throw new Error("Registering a new service with `app.service(path, service)` is no longer supported. Use `app.use(path, service)` instead.");var r=o(e),n=this.services[r];return void 0===n&&"function"==typeof this.defaultService?this.use("/"+r,this.defaultService(r)).service(r):n},use:function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e||""===o(e))throw new Error("'"+e+"' is not a valid service path.");var s=o(e),u="function"==typeof t.service&&t.services,c=this.methods.concat("setup").some(function(e){return t&&"function"==typeof t[e]});if(u){var f=t;return Object.keys(f.services).forEach(function(e){return r.use(s+"/"+e,f.service(e))}),this}if(!c)throw new Error("Invalid service object passed for path `"+s+"`");var l=a.isPrototypeOf(t)?t:a.extend(t);return n("Registering new service at `"+s+"`"),this.mixins.forEach(function(e){return e.call(r,l,s,i)}),"function"==typeof l._setup&&l._setup(this,s),this.providers.forEach(function(e){return e.call(r,l,s,i)}),this._isSetup&&"function"==typeof l.setup&&(n("Setting up service for `"+s+"`"),l.setup(this,s)),this.services[s]=l,this},setup:function(){var e=this;return Object.keys(this.services).forEach(function(t){var r=e.services[t];n("Setting up service for `"+t+"`"),"function"==typeof r.setup&&r.setup(e,t)}),this._isSetup=!0,this}};e.exports=f},function(e,t,r){(function(n){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(12)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(i=++o)}),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,r(3))},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var s=new Array(arguments.length),u=0;u<s.length;u++)s[u]=arguments[u];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=s[c];r=o.call(e,i),s.splice(c,1),c--}return r}),t.formatArgs.call(e,s),(n.log||t.log||console.log.bind(console)).apply(e,s)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(13),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){var r=1e3,n=6e4,o=36e5,i=24*o;function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){return s(e,i,"day")||s(e,o,"hour")||s(e,n,"minute")||s(e,r,"second")||e+" ms"}(e):function(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=n?Math.round(e/n)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"use strict";var n=r(15).EventEmitter,o=r(2),i=t.eventHook=function(){return function(e){var t=e.app,r=e.service,n=t.eventMappings[e.method],o=r._hookEvents&&-1!==r._hookEvents.indexOf(n);n&&o&&"error"!==e.type&&(Array.isArray(e.result)?e.result:[e.result]).forEach(function(t){return r.emit(n,t,e)})}},s=t.eventMixin=function(e){if(!e._serviceEvents){var t=this,r="function"==typeof e.on&&"function"==typeof e.emit;"function"!=typeof e.mixin||r||e.mixin(n.prototype),Object.defineProperties(e,{_serviceEvents:{value:Array.isArray(e.events)?e.events.slice():[]},_hookEvents:{value:[]}}),Object.keys(t.eventMappings).forEach(function(r){var n=t.eventMappings[r],o=-1!==e._serviceEvents.indexOf(n);"function"!=typeof e[r]||o||(e._serviceEvents.push(n),e._hookEvents.push(n))})}};e.exports=function(){return function(e){Object.assign(e,{eventMappings:{create:"created",update:"updated",remove:"removed",patch:"patched"}}),e.hooks({finally:i()}),o.mixin(n.prototype,e),e.mixins.push(s)}}},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,s,u,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(i(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(o(r))for(u=Array.prototype.slice.call(arguments,1),s=(a=r.slice()).length,c=0;c<s;c++)a[c].apply(this,u);return!0},r.prototype.addListener=function(e,t){var s;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(s=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function o(){this.removeListener(e,o),r||(r=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},r.prototype.removeListener=function(e,t){var r,i,s,u;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(u=s;u-- >0;)if(r[u]===t||r[u].listener&&r[u].listener===t){i=u;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";var n=r(0),o=n.hooks,i=n.validateArguments,s=n.isPromise,u=n._,c=o.createHookObject,a=o.getHooks,f=o.processHooks,l=o.enableHooks,p=o.makeArguments,h=t.hookMixin=function(e){if("function"!=typeof e.hooks){var t=this,r=t.methods,n={};l(e,r,t.hookTypes),r.forEach(function(r){"function"==typeof e[r]&&(n[r]=function(){var e=this,n=Array.from(arguments),o=!0===n[n.length-1]&&n.pop(),l=e._super.bind(e),h=c(r,n,{type:"before",service:e,app:t}),v=[function(e){return i(r,n),e}].concat(a(t,e,"before",r));return f.call(e,v,h).then(function(e){if(void 0!==e.result)return e;var t=l.apply(void 0,p(e));if(!s(t))throw new Error("Service method '"+e.method+"' for '"+e.path+"' service must return a promise");return t.then(function(t){return e.result=t,e})}).then(function(e){return Object.assign({},e,{type:"after"})}).then(function(n){var o=a(t,e,"after",r,!0),i=a(t,e,"finally",r,!0),s=o.concat(i);return f.call(e,s,n)}).then(function(e){return o?e:e.result}).catch(function(n){var i=a(t,e,"error",r,!0),s=a(t,e,"finally",r,!0),c=i.concat(s),l=u.omit(Object.assign({},n.hook,h,{type:"error",original:n.hook,error:n}),"result");return f.call(e,c,l).catch(function(e){return l.error=e,l}).then(function(e){return o?void 0!==e.result?e:Promise.reject(e):void 0!==e.result?e.result:Promise.reject(e.error)})})})}),e.mixin(n)}};e.exports=function(){return function(e){Object.assign(e,{hookTypes:["before","after","error","finally"]}),l(e,e.methods,e.hookTypes),e.mixins.push(h)}}}])});